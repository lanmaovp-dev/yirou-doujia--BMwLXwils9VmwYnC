[合集 \- FFmpeg开发实战(57\)](https://github.com)[1\.FFmpeg开发笔记（一）搭建Linux系统的开发环境2023\-04\-16](https://github.com/aqi00/p/17323833.html)[2\.FFmpeg开发笔记（二）搭建Windows系统的开发环境2023\-04\-29](https://github.com/aqi00/p/17363751.html)[3\.FFmpeg开发笔记（三）FFmpeg的可执行程序介绍03\-09](https://github.com/aqi00/p/18062895)[4\.FFmpeg开发笔记（四）FFmpeg的动态链接库介绍03\-10](https://github.com/aqi00/p/18062898)[5\.FFmpeg开发笔记（五）更新MSYS的密钥环03\-16](https://github.com/aqi00/p/18062901)[6\.FFmpeg开发笔记（六）如何访问Github下载FFmpeg源码03\-17](https://github.com/aqi00/p/18062902)[7\.FFmpeg开发笔记（九）Linux交叉编译Android的x265库03\-30](https://github.com/aqi00/p/18078413)[8\.FFmpeg开发笔记（十）Linux环境给FFmpeg集成vorbis和amr03\-31](https://github.com/aqi00/p/18078414)[9\.FFmpeg开发笔记（十一）Windows环境给FFmpeg集成vorbis和amr04\-05](https://github.com/aqi00/p/18078415)[10\.FFmpeg开发笔记（七）欧拉系统编译安装FFmpeg03\-23](https://github.com/aqi00/p/18062905)[11\.FFmpeg开发笔记（八）Linux交叉编译Android的FFmpeg库03\-24](https://github.com/aqi00/p/18062906)[12\.FFmpeg开发笔记（十二）Linux环境给FFmpeg集成libopus和libvpx04\-06](https://github.com/aqi00/p/18105739)[13\.FFmpeg开发笔记（十三）Windows环境给FFmpeg集成libopus和libvpx04\-13](https://github.com/aqi00/p/18105744)[14\.FFmpeg开发笔记（十四）FFmpeg音频重采样的缓存04\-14](https://github.com/aqi00/p/18105749)[15\.FFmpeg开发笔记（十五）详解MediaMTX的推拉流04\-20](https://github.com/aqi00/p/18105753)[16\.FFmpeg开发笔记（十六）Linux交叉编译Android的OpenSSL库04\-21](https://github.com/aqi00/p/18132687)[17\.FFmpeg开发笔记（十七）Windows环境给FFmpeg集成字幕库libass04\-27](https://github.com/aqi00/p/18132702)[18\.FFmpeg开发笔记（十八）FFmpeg兼容各种音频格式的播放05\-04](https://github.com/aqi00/p/18132704)[19\.FFmpeg开发笔记（十九）FFmpeg开启两个线程分别解码音视频05\-05](https://github.com/aqi00/p/18161897)[20\.FFmpeg开发笔记（二十）Linux环境给FFmpeg集成AVS3解码器05\-12](https://github.com/aqi00/p/18161901)[21\.FFmpeg开发笔记（二十一）Windows环境给FFmpeg集成AVS3解码器05\-18](https://github.com/aqi00/p/18161908)[22\.FFmpeg开发笔记（二十二）FFmpeg中SAR与DAR的显示宽高比05\-19](https://github.com/aqi00/p/18161912)[23\.FFmpeg开发笔记（二十三）使用OBS Studio开启RTMP直播推流05\-26](https://github.com/aqi00/p/18199486)[24\.FFmpeg开发笔记（二十四）Linux环境给FFmpeg集成AV1的编解码器05\-27](https://github.com/aqi00/p/18199491)[25\.FFmpeg开发笔记（二十五）Linux环境给FFmpeg集成libwebp06\-01](https://github.com/aqi00/p/18199496)[26\.FFmpeg开发笔记（二十六）Linux环境安装ZLMediaKit实现视频推流06\-02](https://github.com/aqi00/p/18199499)[27\.FFmpeg开发笔记（二十七）解决APP无法访问ZLMediaKit的直播链接问题06\-08](https://github.com/aqi00/p/18199503)[28\.FFmpeg开发笔记（二十八）Linux环境给FFmpeg集成libxvid06\-09](https://github.com/aqi00/p/18199506)[29\.FFmpeg开发笔记（二十九）Windows环境给FFmpeg集成libxvid06\-15](https://github.com/aqi00/p/18239870):[FlowerCloud机场](https://hushicha.org)[30\.FFmpeg开发笔记（三十）解析H.264码流中的SPS帧和PPS帧06\-16](https://github.com/aqi00/p/18239876)[31\.FFmpeg开发笔记（三十一）使用RTMP Streamer开启APP直播推流06\-22](https://github.com/aqi00/p/18239879)[32\.FFmpeg开发笔记（三十二）利用RTMP协议构建电脑与手机的直播Demo06\-23](https://github.com/aqi00/p/18239882)[33\.FFmpeg开发笔记（三十三）分析ZLMediaKit对H.264流的插帧操作06\-29](https://github.com/aqi00/p/18240179)[34\.FFmpeg开发笔记（三十四）Linux环境给FFmpeg集成libsrt和librist06\-30](https://github.com/aqi00/p/18240185)[35\.FFmpeg开发笔记（三十五）Windows环境给FFmpeg集成libsrt07\-06](https://github.com/aqi00/p/18240192)[36\.FFmpeg开发笔记（三十六）Linux环境安装SRS实现视频直播推流07\-07](https://github.com/aqi00/p/18240199)[37\.FFmpeg开发笔记全目录（FFmpeg开发实战详解，含直播系统的搭建过程）06\-17](https://github.com/aqi00/p/18250735)[38\.FFmpeg开发笔记（三十七）分析SRS对HLS协议里TS包的插帧操作07\-13](https://github.com/aqi00/p/18288623)[39\.FFmpeg开发笔记（三十八）APP如何访问SRS推流的RTMP直播地址07\-14](https://github.com/aqi00/p/18288628)[40\.FFmpeg开发笔记（三十九）给Visual Studio的C\+\+工程集成FFmpeg07\-20](https://github.com/aqi00/p/18288635)[41\.FFmpeg开发笔记（四十）Nginx集成rtmp模块实现RTMP推拉流07\-21](https://github.com/aqi00/p/18288637)[42\.FFmpeg开发笔记（四十一）结合OBS与MediaMTX实现SRT直播推流07\-27](https://github.com/aqi00/p/18288640)[43\.FFmpeg开发笔记（四十二）使用ZLMediaKit开启SRT视频直播服务07\-28](https://github.com/aqi00/p/18288642)[44\.FFmpeg开发笔记（四十三）使用SRS开启SRT协议的视频直播服务08\-03](https://github.com/aqi00/p/18288645)[45\.FFmpeg开发笔记（四十四）毕业设计可做的几个拉满颜值的音视频APP08\-04](https://github.com/aqi00/p/18328118)[46\.FFmpeg开发笔记（四十五）使用SRT Streamer开启APP直播推流08\-10](https://github.com/aqi00/p/18328119)[47\.FFmpeg开发笔记（四十六）利用SRT协议构建手机APP的直播Demo08\-11](https://github.com/aqi00/p/18328121)[48\.FFmpeg开发笔记（四十七）寒冬下安卓程序员的几个技术转型发展方向08\-17](https://github.com/aqi00/p/18328122)[49\.FFmpeg开发笔记（四十八）从0开始搭建直播系统的开源软件架构08\-18](https://github.com/aqi00/p/18328123)[50\.FFmpeg开发笔记（四十九）助您在毕业设计中脱颖而出的几个流行APP08\-31](https://github.com/aqi00/p/18328125)[51\.FFmpeg开发笔记（五十）聊聊几种流媒体传输技术的前世今生09\-01](https://github.com/aqi00/p/18390366)[52\.FFmpeg开发笔记（五十一）适合学习研究的几个音视频开源框架09\-07](https://github.com/aqi00/p/18390371)[53\.FFmpeg开发笔记（五十二）移动端的国产视频播放器GSYVideoPlayer09\-08](https://github.com/aqi00/p/18390374)[54\.FFmpeg开发笔记（五十三）移动端的国产直播录制工具EasyPusher09\-21](https://github.com/aqi00/p/18390381)[55\.FFmpeg开发笔记（五十四）使用EasyPusher实现移动端的RTSP直播09\-22](https://github.com/aqi00/p/18390389)[56\.FFmpeg开发笔记（五十五）寒冬里的安卓程序员可进阶修炼的几种姿势10\-12](https://github.com/aqi00/p/18450136)57\.FFmpeg开发笔记（五十六）使用Media3的Exoplayer播放网络视频10\-13收起
​Android早期的MediaPlayer控件对于网络视频的兼容性很差，所以后来单独推出了Exoplayer库增强支持网络视频，在《Android Studio开发实战：从零基础到App上线(第3版)》一书第14章的“14\.3\.3  新型播放器ExoPlayer”就详细介绍了Exoplayer库的详细用法。
 现在Android官方再次升级Exoplayer，并将其纳入了Jetpack的Media3第三代媒体库，作为音视频相关操作的统一处理引擎。升级后的Exoplayer就成为Media3的统一媒体播放引擎，提供了音频和视频播放的应用级组件，意欲在音视频渲染方向上一统江湖。
根据Android官网的介绍，ExoPlayer还摆脱设备和操作系统碎片化问题，让App代码以一致的方式运行于整个Android生态系统中。因为Media3是个很新很新的Jetpack库，所以它对开发环境要求比较高，需满足下列条件才能正常引入Media3。
1、开发工具要选用Android Studio Jellyfish（小水母版本）或更高版本。
2、Gradle版本不低于8\.6。
3、App模块的build.gradle里面compileSdk和targetSdk要升级到34或者更高版本。
根据上述条件准备好了开发环境，再按照以下描述引入Media3的ExoPlayer库，详细步骤说明如下。


# 一、修改模块的build.gradle


在build.gradle的dependencies节点内部补充下面的导包语句，把ExoPlayer用到的相关库都加进来。




```
implementation "androidx.media3:media3-exoplayer:1.4.0"
implementation "androidx.media3:media3-exoplayer-hls:1.4.0"
implementation "androidx.media3:media3-exoplayer-rtsp:1.4.0"
implementation "androidx.media3:media3-ui:1.4.0"
implementation "androidx.media3:media3-common:1.4.0"
implementation "androidx.media3:media3-session:1.4.0"
implementation "androidx.media3:media3-datasource:1.4.0"
implementation "androidx.media3:media3-datasource-rtmp:1.4.0"
```


# 二、编辑播放界面的布局文件


打开播放界面的XML布局文件，给根布局添加如下的属性配置：




```
xmlns:app="http://schemas.android.com/apk/res-auto"
```


接着在布局内部添加来自ExoPlayer库的PlayerView控件节点，举例如下：




```

<androidx.media3.ui.PlayerView
    android:id="@+id/pv_content"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:show_buffering="always"
    app:show_timeout="5000"
    app:use_controller="true"
    app:resize_mode="fit"/>
```


# 三、活动页面代码增加ExoPlayer的处理代码


首先补充下面一行代码声明PlayerView对象：




```
private ExoPlayer mPlayer; // 声明一个新型播放器对象
```


接着在onCreate方法里面补充以下代码，获取PlayerView对象，并对其设置ExoPlayer的播放器对象：




```
    PlayerView pv_content = findViewById(R.id.pv_content);
    mPlayer = new ExoPlayer.Builder(this).build();
    pv_content.setPlayer(mPlayer); // 设置播放器视图的播放器对象
```


然后添加下面的播放方法，开始播放指定链接的网络视频。




```
// 播放视频
private void playVideo(Uri uri) {
    DataSource.Factory factory = new DefaultDataSource.Factory(this);
    // 创建指定地址的媒体对象
    MediaItem videoItem = new MediaItem.Builder().setUri(uri).build();
    // 基于工厂对象和媒体对象创建媒体来源
    MediaSource videoSource;
    if (uri.getPath().endsWith("m3u8")) { // hls链接
        videoSource = new HlsMediaSource.Factory(factory)
                .createMediaSource(videoItem);
    } else if (uri.getPath().startsWith("rtsp")) { // rtsp链接
        videoSource = new RtspMediaSource.Factory()
                .createMediaSource(videoItem);
    } else if (uri.getPath().startsWith("rtmp")) { // rtmp链接
        videoSource = new ProgressiveMediaSource.Factory(new RtmpDataSource.Factory())
                .createMediaSource(videoItem);
    } else { // 其他链接（http开头或https开头的普通视频链接）
        videoSource = new ProgressiveMediaSource.Factory(factory)
                .createMediaSource(videoItem);
    }
    mPlayer.setMediaSource(videoSource); // 设置播放器的媒体来源
    mPlayer.prepare(); // 播放器准备就绪
    mPlayer.play(); // 播放器开始播放
}
```


从上述的播放代码可知，这里用到了ExoPlayer的四种播放形式，分别为：播放HLS链接、播放RTMP链接、播放RTSP链接、播放普通网络视频。


# 四、给AndroidManifest.xml补充互联网访问权限


打开AndroidManifest.xml，添加下面的互联网权限配置：




```
<uses-permission android:name="android.permission.INTERNET" />
```


最后编译运行App，在真机上看到的播放器效果如下图所示。


![](https://img2024.cnblogs.com/blog/729938/202410/729938-20241007152626144-564751580.jpg)


可见成功把Media3的ExoPlayer库跑了起来，并且正常播放网络视频。


更多详细的FFmpeg开发知识参见[《FFmpeg开发实战：从零基础到短视频上线》](https://item.jd.com/14020415.html "《FFmpeg开发实战：从零基础到短视频上线》")一书。


 


​
